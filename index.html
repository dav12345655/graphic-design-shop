<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Online Graphic Shop</title>

<!-- SweetAlert2 -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<!-- Paystack inline -->
<script src="https://js.paystack.co/v1/inline.js"></script>

<style>
  :root{
    --bg1:#4f46e5;
    --bg2:#7c3aed;
    --card:#ffffffcc;
    --muted:#6b7280;
  }
  html,body{
    height:100%;margin:0;
    font-family:Inter,system-ui,Segoe UI,Arial,sans-serif;
    background:linear-gradient(135deg,var(--bg1),var(--bg2));
    color:#0f172a;
  }
  header{
    background:rgba(255,255,255,0.15);
    color:#fff;
    padding:40px 10px;
    text-align:center;
    backdrop-filter:blur(8px);
  }
  header h1{margin:0;font-size:36px;font-weight:900;}
  header p{margin:6px 0 0;opacity:0.9;font-size:14px}
  .container{
    max-width:1100px;
    margin:20px auto;
    padding:12px;
  }
  .product-grid{
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
    gap:18px;
  }
  .product{
    background:var(--card);
    border-radius:12px;
    overflow:hidden;
    box-shadow:0 8px 24px rgba(16,24,40,0.15);
    display:flex;
    flex-direction:column;
    transition:transform 0.2s ease,box-shadow 0.2s ease;
  }
  .product:hover{transform:translateY(-3px);box-shadow:0 10px 28px rgba(16,24,40,0.2);}
  .product img{width:100%;height:180px;object-fit:cover;}
  .info{padding:10px 12px;flex:1;display:flex;flex-direction:column;justify-content:space-between}
  .info h3{margin:0;font-size:16px;font-weight:700}
  .info p{margin:4px 0 0;color:var(--muted);font-size:14px}
  .price{font-weight:800;font-size:15px;margin-top:8px}
  .btn{
    background:linear-gradient(90deg,#0ea5e9,#7c3aed);
    color:#fff;border:0;border-radius:8px;
    padding:10px;font-weight:700;cursor:pointer;
    transition:opacity 0.2s ease;
  }
  .btn:hover{opacity:0.9;}
  footer{text-align:center;color:#fff;padding:20px;font-size:13px;margin-top:30px;}

  /* floating buttons */
  .top-buttons {
    position: fixed;
    top: 140px;
    right: 20px;
    display:flex;
    flex-direction:column;
    gap:10px;
    z-index:1000;
    align-items:flex-end;
  }
  .cart-btn, .wallet-display {
    background:#fff;
    color:#111;
    border-radius:30px;
    padding:10px 16px;
    display:flex;
    align-items:center;
    gap:6px;
    box-shadow:0 8px 20px rgba(0,0,0,0.15);
    cursor:pointer;
    font-weight:700;
  }
  .logout-btn {
    background:#ef4444;
    color:#fff;
    border:none;
    border-radius:20px;
    padding:6px 12px;
    font-weight:700;
    font-size:13px;
    box-shadow:0 6px 16px rgba(0,0,0,0.15);
    cursor:pointer;
  }
  .logout-btn:hover{opacity:0.9;}
  .whatsapp{
    position:fixed;right:18px;bottom:18px;width:64px;height:64px;border-radius:50%;
    background:#25D366;color:#fff;display:flex;align-items:center;justify-content:center;font-size:28px;
    z-index:9999;box-shadow:0 10px 30px rgba(2,6,23,0.25);text-decoration:none;
  }
</style>
</head>
<body>
  <header>
    <h1>Welcome to Online Graphic Shop</h1>
    <p>Creative designs, flyers, posters & more</p>
  </header>

  <div class="top-buttons">
    <button class="logout-btn" id="logoutBtn">Logout</button>
    <div id="walletDisplay" class="wallet-display" title="Click to deposit">
      ðŸ’° Wallet: â‚¦<span id="wallet-amount">0.00</span>
    </div>
    <div class="cart-btn" id="cartBtn" title="View cart">
      ðŸ›’ Cart (<span id="cart-count">0</span>)
    </div>
  </div>

  <div class="container">
    <div class="product-grid" id="product-grid"></div>
  </div>

  <footer>Â© <span id="year"></span> Online Graphic Shop â€” Designed by <strong>ABblack</strong></footer>

  <a class="whatsapp" href="https://wa.me/2349121383292" target="_blank">ðŸ’¬</a>

  <!-- Deposit Modal -->
  <div id="depositModal" style="display:none;position:fixed;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,0.6);align-items:center;justify-content:center;z-index:2000">
    <div style="background:#fff;padding:20px;border-radius:10px;max-width:400px;margin:auto;text-align:center">
      <h3>Deposit to Wallet</h3>
      <p>Enter amount (â‚¦)</p>
      <input type="number" id="depositAmountInput" min="100" max="50000" placeholder="Min â‚¦100 â€” Max â‚¦50,000" style="padding:10px;border-radius:8px;border:1px solid #ddd;width:80%;margin-top:8px">
      <div style="display:flex;gap:8px;justify-content:center;margin-top:12px">
        <button id="startDepositBtn" class="btn" style="background:#06b6d4">Proceed to Pay</button>
        <button id="cancelDeposit" class="btn" style="background:#6b7280">Cancel</button>
      </div>
    </div>
  </div>

<script>
document.getElementById("year").textContent=new Date().getFullYear();

// Load products (from Admin)
let storedProducts = JSON.parse(localStorage.getItem("products")) || [];
let products = storedProducts.length ? storedProducts : [
  {name:"Party",price:3000,category:"FLYER",image:"https://i.pinimg.com/1200x/41/61/f4/4161f44b77d1240bf7549c6dbb445055.jpg"},
  {name:"Blast",price:2000,category:"FLYER",image:"https://i.pinimg.com/1200x/ab/d3/79/abd379cd2b568cb5503662c48d3c981f.jpg"},
  {name:"The GOAT",price:2000,category:"GRAPHICS",image:"https://i.pinimg.com/736x/d2/62/9a/d2629a92a49e363ed0446bcc3a98f66a.jpg"},
  {name:"V Design",price:2500,category:"GRAPHICS",image:"https://i.pinimg.com/1200x/3a/15/f2/3a15f2cb8387639c5abec72284267654.jpg"}
];

function readCart(){try{return JSON.parse(localStorage.getItem('ogshop_cart'))||[];}catch{return[];}}
function saveCart(cart){localStorage.setItem('ogshop_cart',JSON.stringify(cart));}
function readWallet(){return parseFloat(localStorage.getItem('ogshop_wallet'))||0;}
function saveWallet(amount){localStorage.setItem('ogshop_wallet',amount);}

const grid=document.getElementById('product-grid');
const cartBtn=document.getElementById('cartBtn');
const walletDisplay=document.getElementById('walletDisplay');
const walletAmountEl=document.getElementById('wallet-amount');
const depositModal=document.getElementById('depositModal');
const depositAmountInput=document.getElementById('depositAmountInput');
const startDepositBtn=document.getElementById('startDepositBtn');
const cancelDeposit=document.getElementById('cancelDeposit');
const cartCountEl=document.getElementById('cart-count');
const logoutBtn=document.getElementById('logoutBtn');

let cart=readCart();
let wallet=readWallet();

function updateCartCount(){cartCountEl.textContent=cart.length;}
function updateWallet(){walletAmountEl.textContent=wallet.toLocaleString();saveWallet(wallet);}
updateCartCount();updateWallet();

function renderProducts(){
  grid.innerHTML='';
  products.forEach((p,i)=>{
    grid.innerHTML+=`
      <div class="product">
        <img src="${p.image}" alt="${p.name}">
        <div class="info">
          <div>
            <h3>${p.name}</h3>
            <p>${p.category}</p>
            <div class="price">â‚¦${p.price.toLocaleString()}</div>
          </div>
          <button class="btn" onclick="preview(${i})">Preview</button>
        </div>
      </div>`;
  });
}
renderProducts();

function preview(i){
  const p=products[i];
  Swal.fire({
    title:p.name,
    html:`<img src="${p.image}" style="width:100%;border-radius:10px;margin-bottom:10px"><p>${p.category}</p><p><b>â‚¦${p.price.toLocaleString()}</b></p>`,
    showCancelButton:true,
    confirmButtonText:'Add to Cart',
    cancelButtonText:'Close',
    confirmButtonColor:'#4f46e5'
  }).then(res=>{
    if(res.isConfirmed)addToCart(p);
  });
}

function addToCart(p){
  if(wallet<p.price)return Swal.fire('Insufficient Balance',`You need â‚¦${p.price.toLocaleString()}`, 'warning');
  if(cart.find(x=>x.name===p.name))return Swal.fire('Already in cart',`${p.name} already added.`, 'info');
  cart.push(p);saveCart(cart);updateCartCount();
  Swal.fire('Added!','Product added successfully.','success');
}

walletDisplay.onclick=()=>depositModal.style.display='flex';
cancelDeposit.onclick=()=>depositModal.style.display='none';
startDepositBtn.onclick=()=>{
  const amt=Number(depositAmountInput.value);
  if(!amt||amt<100||amt>50000)return Swal.fire('Invalid amount','Enter between â‚¦100â€“â‚¦50,000','error');
  depositModal.style.display='none';
  Swal.fire({title:'Processing...',didOpen:()=>Swal.showLoading()});
  setTimeout(()=>{
    wallet+=amt;updateWallet();
    Swal.fire('Deposit successful',`â‚¦${amt.toLocaleString()} added to wallet`,'success');
  },1200);
};

cartBtn.onclick=()=>{
  if(!cart.length)return Swal.fire('Cart Empty','Add items before checkout.','info');
  Swal.fire({
    title:'Your Cart',
    html:cart.map((x,i)=>`<div style="display:flex;justify-content:space-between;padding:5px 0">
      <span>${x.name} - â‚¦${x.price.toLocaleString()}</span>
      <button class='btn' style='padding:5px 8px;background:#ef4444' onclick='removeItem(${i})'>X</button>
    </div>`).join(''),
    showCancelButton:true,
    confirmButtonText:'Checkout'
  }).then(r=>{
    if(r.isConfirmed)window.location='checkout.html';
  });
};
function removeItem(i){cart.splice(i,1);saveCart(cart);updateCartCount();cartBtn.click();}

logoutBtn.onclick=()=>{
  Swal.fire({
    title:'Logout?',
    text:'You will be signed out of your account.',
    icon:'warning',
    showCancelButton:true,
    confirmButtonText:'Yes, Logout',
    confirmButtonColor:'#ef4444'
  }).then(res=>{
    if(res.isConfirmed){
      localStorage.removeItem('loggedInUser');
      Swal.fire('Logged out','You have been signed out.','success');
      setTimeout(()=>window.location='login.html',1200);
    }
  });
};
</script>
</body>
</html>
