<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Online Graphic Shop</title>
<style>
  :root{--accent:#6c63ff;--muted:#6b7280}
  body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;margin:0;background:#f4f6fb;color:#0f172a}
  header{background:linear-gradient(90deg,var(--accent),#4b59ff);color:#fff;padding:14px 18px;display:flex;align-items:center;justify-content:space-between;gap:12px}
  header h1{margin:0;font-size:18px}
  .top-controls{display:flex;gap:8px;align-items:center}
  input[type="search"], select{padding:8px;border-radius:10px;border:0;min-width:180px}
  main.container{max-width:1200px;margin:18px auto;padding:0 14px;display:grid;grid-template-columns:1fr 320px;gap:18px}
  section.catalog{min-height:60vh}
  .controls{display:flex;gap:8px;align-items:center;margin-bottom:12px;flex-wrap:wrap}
  #products-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:14px}
  .card{background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 8px 24px rgba(16,24,40,0.06);display:flex;flex-direction:column;transition:transform .18s}
  .card:hover{transform:translateY(-6px)}
  .media{height:140px;background:#eee;display:block;overflow:hidden}
  .media img{width:100%;height:100%;object-fit:cover;display:block}
  .body{padding:10px 12px;display:flex;flex-direction:column;gap:6px;flex:1}
  .title{font-weight:700;font-size:14px}
  .meta{color:var(--muted);font-size:13px}
  .price{font-weight:800;color:#111}
  .actions{display:flex;gap:8px;margin-top:auto}
  .btn{padding:8px;border-radius:8px;border:0;cursor:pointer;font-weight:600}
  .btn-primary{background:var(--accent);color:#fff}
  .btn-ghost{background:#fff;border:1px solid #e6e9ef}
  aside.panel{background:#fff;border-radius:12px;padding:12px;box-shadow:0 8px 24px rgba(16,24,40,0.04);height:fit-content}
  .cart-list{max-height:320px;overflow:auto;margin-top:8px;display:flex;flex-direction:column;gap:8px}
  .cart-row{display:flex;align-items:center;gap:8px;justify-content:space-between}
  .cart-row img{width:56px;height:44px;object-fit:cover;border-radius:6px}
  footer{margin-top:20px;text-align:center;color:var(--muted);padding:18px}
  #modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(2,6,23,0.45);z-index:60}
  #modal-card{width:100%;max-width:880px;background:#fff;border-radius:12px;display:grid;grid-template-columns:360px 1fr;overflow:hidden}
  #modal-card img{width:100%;height:100%;object-fit:cover}
  #modal-body{padding:14px}
  .badge{background:#ff7a59;color:#fff;padding:6px 8px;border-radius:8px;font-weight:700;font-size:12px}
  .loading{padding:12px;text-align:center;color:var(--muted)}
  @media (max-width:980px){ main.container{grid-template-columns:1fr} #modal-card{grid-template-columns:1fr} aside.panel{order:2} }
</style>
</head>
<body>

<header>
  <h1>Online Graphic Shop</h1>
  <div class="top-controls">
    <div style="display:flex;gap:8px;align-items:center" class="controls">
      <input id="search" type="search" placeholder="Search designs, e.g., logo, flyer..." aria-label="Search">
      <select id="category">
        <option value="all">All categories</option>
      </select>
      <select id="sort">
        <option value="relevance">Sort</option>
        <option value="price_asc">Price ↑</option>
        <option value="price_desc">Price ↓</option>
      </select>
    </div>
    <button id="open-cart" class="btn btn-primary">Cart (<span id="cart-count">0</span>)</button>
  </div>
</header>

<main class="container">
  <section class="catalog">
    <div id="products-grid" aria-live="polite"></div>
    <div id="infinite-loading" class="loading">Scroll to load more designs...</div>
  </section>

  <aside class="panel">
    <h3>Your Cart</h3>
    <div id="cart-items" class="cart-list"></div>
    <div style="margin-top:10px;font-weight:800">Total: ₦<span id="cart-total">0</span></div>
    <div style="margin-top:10px;display:flex;gap:8px">
      <button id="go-checkout" class="btn btn-primary" style="flex:1">Checkout</button>
      <button id="clear-cart" class="btn btn-ghost">Clear</button>
    </div>
    <div style="margin-top:12px;font-size:13px;color:var(--muted)">
      Payment (after checkout):<br><strong>Joy Gift</strong><br>Account: <strong>9121383292</strong><br>Bank: <strong>Opay</strong>
    </div>
  </aside>
</main>

<!-- modal -->
<div id="modal" role="dialog" aria-modal="true">
  <div id="modal-card">
    <img id="modal-img" src="" alt="">
    <div id="modal-body">
      <h3 id="modal-title"></h3>
      <div id="modal-meta" class="meta"></div>
      <p id="modal-desc" style="margin-top:10px;color:#334155"></p>
      <div style="margin-top:12px;font-weight:800;font-size:18px">₦<span id="modal-price"></span></div>
      <div style="margin-top:12px;display:flex;gap:8px;">
        <button id="modal-add" class="btn btn-primary">Add to cart</button>
        <button id="modal-close" class="btn btn-ghost">Close</button>
      </div>
    </div>
  </div>
</div>

<footer>
  © <span id="year"></span> Online Graphic Shop — designs for businesses and creatives
</footer>

<script>
/* -------------------------
  Client-side product manager
  - Generates 700 products once (saved in localStorage)
  - Loads chunks (infinite scroll)
  - Search, category, sort
  - Cart saved in localStorage
--------------------------*/

const TOTAL_PRODUCTS = 700;
const CHUNK = 36; // load 36 at a time
const CATEGORIES = ['Logos','Social Media','Flyers','Banners','UI Kits','Icons','Posters','Invites'];

const STATE = {
  products: [],
  loaded: 0,
  query: '',
  category: 'all',
  sortBy: 'relevance',
  cart: JSON.parse(localStorage.getItem('ogshop_cart') || '{}') || {},
};

// quick helpers
const $ = (s,r=document)=>r.querySelector(s);
const $$ = (s,r=document)=>Array.from(r.querySelectorAll(s));
const currency = n => "₦" + Number(n).toLocaleString('en-NG');
const rand = (min,max)=>Math.floor(Math.random()*(max-min+1))+min;

// generate or load products
function makeProducts(){
  const saved = localStorage.getItem('ogshop_products_v1');
  if(saved){
    try{ STATE.products = JSON.parse(saved); return; } catch(e){ console.warn('bad saved products'); }
  }
  const arr = [];
  let idx = 1;
  while(arr.length < TOTAL_PRODUCTS){
    const cat = CATEGORIES[(idx-1) % CATEGORIES.length];
    const title = `${cat} Design #${idx}`;
    // price 1,500 - 12,000
    const price = rand(1500, 12000);
    const oldPrice = Math.random()>0.8 ? price + Math.round(rand(200, Math.floor(price*0.35))) : null;
    const rating = (3.5 + Math.random()*1.5).toFixed(1);
    const reviews = rand(0,1200);
    // Unsplash placeholder with sig so images vary on GitHub Pages
    const img = `https://source.unsplash.com/800x600/?graphic%20design,template,${encodeURIComponent(cat)}&sig=${idx}`;
    const desc = `High-quality ${cat.toLowerCase()} template, editable and ready for your brand.`;
    const badge = Math.random()>0.95 ? 'Bestseller' : (Math.random()>0.95 ? 'New' : '');
    arr.push({ id: 'GFX' + String(idx).padStart(4,'0'), title, price, oldPrice, rating, reviews, category:cat, img, desc, badge });
    idx++;
  }
  STATE.products = arr;
  try{ localStorage.setItem('ogshop_products_v1', JSON.stringify(arr)); } catch(e){ console.warn('storage full?'); }
}

// UI rendering
const grid = $('#products-grid');
const loadingNote = $('#infinite-loading');
const cartCountEl = $('#cart-count');
const cartItemsEl = $('#cart-items');
const cartTotalEl = $('#cart-total');
const searchEl = $('#search');
const categoryEl = $('#category');
const sortEl = $('#sort');
const yearEl = $('#year');

function fillCategoryOptions(){
  const cats = ['all', ...CATEGORIES];
  categoryEl.innerHTML = cats.map(c=>`<option value="${c.toLowerCase()}">${c}</option>`).join('');
}

function getFiltered(){
  let list = STATE.products.slice();
  const q = STATE.query.trim().toLowerCase();
  if(q) list = list.filter(p=> p.title.toLowerCase().includes(q) || p.desc.toLowerCase().includes(q));
  if(STATE.category !== 'all') list = list.filter(p => p.category.toLowerCase() === STATE.category);
  switch(STATE.sortBy){
    case 'price_asc': list.sort((a,b)=>a.price-b.price); break;
    case 'price_desc': list.sort((a,b)=>b.price-a.price); break;
    default: break;
  }
  return list;
}

function renderChunk(){
  const list = getFiltered();
  const start = STATE.loaded;
  const next = Math.min(list.length, start + CHUNK);
  const slice = list.slice(start, next);
  for(const p of slice){
    const el = document.createElement('div');
    el.className = 'card';
    el.innerHTML = `
      <div class="media"><img loading="lazy" src="${p.img}" alt="${p.title}" data-id="${p.id}"></div>
      <div class="body">
        ${p.badge ? `<div class="badge">${p.badge}</div>` : ''}
        <div class="title">${p.title}</div>
        <div class="meta">${p.category} • ${p.rating} ⭐ (${p.reviews})</div>
        <div class="price">${currency(p.price)} ${p.oldPrice?` <span style="text-decoration:line-through;color:#a1a1aa;margin-left:8px">${currency(p.oldPrice)}</span>`:''}</div>
        <div class="actions">
          <button class="btn btn-ghost view-btn" data-id="${p.id}">Preview</button>
          <button class="btn btn-primary add-btn" data-id="${p.id}">Add</button>
        </div>
      </div>`;
    grid.appendChild(el);
  }
  STATE.loaded = next;
  if(STATE.loaded >= list.length){
    loadingNote.textContent = 'All designs loaded';
  } else {
    loadingNote.textContent = 'Scroll to load more designs...';
  }
}

function resetAndRender(){
  grid.innerHTML = '';
  STATE.loaded = 0;
  renderChunk();
}

function handleScroll(){
  const nearBottom = window.innerHeight + window.scrollY >= document.body.offsetHeight - 1200;
  if(nearBottom){
    renderChunk();
  }
}

/* cart functions */
function saveCart(){ localStorage.setItem('ogshop_cart', JSON.stringify(STATE.cart)); }
function updateCartUI(){
  cartItemsEl.innerHTML = '';
  const items = Object.entries(STATE.cart).map(([id,qty])=>{
    const p = STATE.products.find(x=>x.id === id) || {title:id,price:0,img:''};
    return {...p, qty};
  });
  let total = 0;
  for(const it of items){
    total += it.price * it.qty;
    const row = document.createElement('div');
    row.className = 'cart-row';
    row.innerHTML = `<div style="display:flex;gap:8px;align-items:center"><img src="${it.img}" alt=""><div><div style="font-weight:700">${it.title}</div><div style="color:var(--muted);font-size:13px">${it.qty} × ${currency(it.price)}</div></div></div>
                     <div style="text-align:right"><div style="font-weight:800">${currency(it.price*it.qty)}</div><div style="margin-top:6px"><button class="btn btn-ghost" data-action="dec" data-id="${it.id}">-</button> <button class="btn btn-ghost" data-action="inc" data-id="${it.id}">+</button> <button class="btn btn-ghost" data-action="remove" data-id="${it.id}">Remove</button></div></div>`;
    cartItemsEl.appendChild(row);
  }
  cartTotalEl.textContent = Number(total).toLocaleString('en-NG');
  const count = items.reduce((s,i)=>s+i.qty,0);
  cartCountEl.textContent = count;
  saveCart();
}

/* interactions */
document.addEventListener('click', (e)=>{
  const view = e.target.closest('.view-btn');
  if(view){
    const id = view.dataset.id;
    const p = STATE.products.find(x=>x.id===id);
    if(p){
      $('#modal-img').src = p.img;
      $('#modal-title').textContent = p.title;
      $('#modal-desc').textContent = p.desc;
      $('#modal-meta').textContent = `${p.category} • ${p.rating} ⭐ (${p.reviews})`;
      $('#modal-price').textContent = Number(p.price).toLocaleString('en-NG');
      $('#modal-add').dataset.id = p.id;
      $('#modal').style.display = 'flex';
    }
  }
  const add = e.target.closest('.add-btn');
  if(add){
    const id = add.dataset.id;
    STATE.cart[id] = (STATE.cart[id] || 0) + 1;
    updateCartUI();
    // small feedback
    add.textContent = 'Added';
    setTimeout(()=> add.textContent = 'Add', 900);
  }
  const modalAdd = e.target.closest('#modal-add');
  if(modalAdd){
    const id = modalAdd.dataset.id;
    STATE.cart[id] = (STATE.cart[id] || 0) + 1;
    updateCartUI();
    $('#modal').style.display = 'none';
  }
  if(e.target.closest('#modal-close') || e.target === $('#modal')){
    $('#modal').style.display = 'none';
  }
  // cart inc/dec/remove
  const cartBtn = e.target.closest('[data-action]');
  if(cartBtn){
    const act = cartBtn.dataset.action;
    const id = cartBtn.dataset.id;
    if(act === 'inc'){ STATE.cart[id] = (STATE.cart[id]||0) + 1; }
    else if(act === 'dec'){ STATE.cart[id] = Math.max(0,(STATE.cart[id]||0)-1); if(STATE.cart[id]===0) delete STATE.cart[id]; }
    else if(act === 'remove'){ delete STATE.cart[id]; }
    updateCartUI();
  }
});

/* search & filters */
searchEl.addEventListener('input', ()=>{
  STATE.query = searchEl.value || '';
  resetAndRender();
});
categoryEl.addEventListener('change', ()=>{
  STATE.category = categoryEl.value;
  resetAndRender();
});
sortEl.addEventListener('change', ()=>{
  STATE.sortBy = sortEl.value;
  resetAndRender();
});

/* cart open, clear, checkout */
$('#open-cart').addEventListener('click', ()=> window.scrollTo({top:0,behavior:'smooth'}));
$('#go-checkout').addEventListener('click', ()=> window.location.href = 'checkout.html');
$('#clear-cart').addEventListener('click', ()=> { if(confirm('Clear cart?')){ STATE.cart = {}; updateCartUI(); } });

/* init */
function boot(){
  yearEl.textContent = new Date().getFullYear();
  makeProducts();
  fillCategoryOptions();
  // see if saved cart exists (already loaded into STATE.cart)
  updateCartUI();
  resetAndRender();
  window.addEventListener('scroll', handleScroll);
}
boot();

</script>
</body>
</html>
