<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Checkout ‚Äî Online Graphic Shop</title>
<style>
  body{font-family:Inter,system-ui,Arial;background:#f4f6fb;color:#0f172a;margin:0}
  header{background:#111;color:#fff;padding:14px 18px;text-align:center}
  main{max-width:900px;margin:24px auto;padding:18px}
  .card{background:#fff;border-radius:12px;padding:14px;box-shadow:0 8px 24px rgba(16,24,40,0.06)}
  .item{display:flex;align-items:center;justify-content:space-between;padding:10px 0;border-bottom:1px dashed #eee}
  .item img{width:80px;height:60px;object-fit:cover;border-radius:6px;margin-right:10px}
  .total{font-weight:900;font-size:20px;margin-top:12px}
  .form{margin-top:12px;display:grid;gap:8px}
  input,textarea{padding:10px;border-radius:8px;border:1px solid #e6e9ef}
  .btn{padding:10px;border-radius:8px;border:0;background:#111;color:#fff;cursor:pointer;font-weight:700}
  .note{background:#fff8f6;border:1px solid #ffdede;padding:10px;border-radius:8px;margin-top:12px}

  /* ‚úÖ Modal styles */
  .modal-overlay{
    position:fixed;top:0;left:0;width:100%;height:100%;
    background:rgba(0,0,0,0.6);display:flex;align-items:center;
    justify-content:center;z-index:10000;visibility:hidden;opacity:0;
    transition:opacity .3s ease,visibility .3s ease;
  }
  .modal-overlay.active{visibility:visible;opacity:1;}
  .modal{
    background:#fff;border-radius:12px;max-width:400px;width:90%;
    padding:24px;text-align:center;box-shadow:0 8px 24px rgba(0,0,0,0.2);
    animation:pop .3s ease;
  }
  @keyframes pop{from{transform:scale(0.8);opacity:0;}to{transform:scale(1);opacity:1;}}
  .modal h2{margin-bottom:10px;}
  .modal p{color:#555;font-size:15px;margin-bottom:20px;}
  .modal button{padding:10px 20px;border:none;border-radius:8px;background:#111;color:#fff;font-weight:600;cursor:pointer;}
  .modal.error h2{color:#e11d48;}
  .modal.success h2{color:#16a34a;}
</style>
</head>

<!-- ‚úÖ Floating WhatsApp Chat Button -->
<a href="https://wa.me/2349121383292" target="_blank" 
   style="
     position: fixed;
     bottom: 20px;
     right: 20px;
     background-color: #25D366;
     color: white;
     border-radius: 50%;
     width: 60px;
     height: 60px;
     display: flex;
     align-items: center;
     justify-content: center;
     box-shadow: 0 4px 8px rgba(0,0,0,0.3);
     font-size: 28px;
     text-decoration: none;
     z-index: 1000;
   ">
   üí¨
</a>

<body>
<header><h1>Checkout ‚Äî Online Graphic Shop</h1></header>
<main>
  <div class="card" id="checkout-card">
    <h3>Order Summary</h3>
    <div id="items"></div>
    <div class="total">Total: ‚Ç¶<span id="total">0</span></div>

    <h4 style="margin-top:16px">Delivery / Contact</h4>
    <div class="form">
      <input id="name" placeholder="Full name" />
      <input id="phone" placeholder="Phone or Email" />
      <textarea id="address" rows="3" placeholder="Address (optional)"></textarea>
    </div>

    <div class="note">
      <strong>Payment details</strong><br>
      Name: <strong>Joy Gift</strong><br>
      Account: <strong>9121383292</strong><br>
      Bank: <strong>Opay</strong><br>
      After payment, click "I have paid" and optionally paste your transaction ID in the box that appears.
    </div>

    <div style="display:flex;gap:10px;margin-top:12px">
      <button id="pay" class="btn" style="flex:1">I have paid</button>
      <button id="back" class="btn" style="background:#e6e6e6;color:#111">Back to shop</button>
    </div>
  </div>
</main>

<!-- ‚úÖ Success Modal -->
<div class="modal-overlay" id="successModal">
  <div class="modal success">
    <h2>‚úÖ Payment Recorded</h2>
    <p>Thank you for your purchase! Your order has been successfully saved.<br>
    We‚Äôll review your payment and contact you shortly.</p>
    <button id="okBtn">Back to Home</button>
  </div>
</div>

<!-- ‚úÖ Error Modal -->
<div class="modal-overlay" id="errorModal">
  <div class="modal error">
    <h2>‚ö†Ô∏è Error</h2>
    <p id="errorText">Something went wrong.</p>
    <button id="closeError">OK</button>
  </div>
</div>

<script>
  // Read cart data
  let cart = JSON.parse(localStorage.getItem('ogshop_cart') || '{}') || {};
  const savedProducts = JSON.parse(localStorage.getItem('ogshop_products_v1') || '[]') || [];

  function buildItems(){
    const itemsDiv = document.getElementById('items');
    itemsDiv.innerHTML = '';
    let total = 0;
    const entries = Object.entries(cart);
    if(entries.length === 0){
      itemsDiv.innerHTML = '<p>Your cart is empty. <a href="index.html">Continue shopping</a></p>';
      document.getElementById('total').textContent = '0';
      return;
    }
    for(const [id, qty] of entries){
      const p = savedProducts.find(x=>x.id === id);
      const price = p ? p.price : 0;
      total += price * qty;
      const row = document.createElement('div');
      row.className = 'item';
      row.innerHTML = `<div style="display:flex;align-items:center">
        <img src="${p?p.img:''}" alt="">
        <div>
          <div style="font-weight:700">${p?p.title:id}</div>
          <div style="color:#667085;font-size:13px">${qty} √ó ‚Ç¶${new Intl.NumberFormat('en-NG').format(price)}</div>
        </div></div>
        <div style="font-weight:800">‚Ç¶${new Intl.NumberFormat('en-NG').format(price*qty)}</div>`;
      itemsDiv.appendChild(row);
    }
    document.getElementById('total').textContent = new Intl.NumberFormat('en-NG').format(total);
  }

  buildItems();

  const successModal = document.getElementById('successModal');
  const errorModal = document.getElementById('errorModal');
  const errorText = document.getElementById('errorText');
  const closeError = document.getElementById('closeError');

  document.getElementById('back').addEventListener('click', ()=> location.href='index.html');

  function showError(msg){
    errorText.textContent = msg;
    errorModal.classList.add('active');
  }

  closeError.addEventListener('click', ()=> errorModal.classList.remove('active'));

  document.getElementById('pay').addEventListener('click', ()=>{
    const name = document.getElementById('name').value.trim();
    const phone = document.getElementById('phone').value.trim();

    if(!name || !phone){
      showError('Please enter your full name and contact information.');
      return;
    }

    const tx = prompt('Enter transaction ID (optional) after payment ‚Äî or press OK to continue without it.');
    if(tx && !/^[A-Za-z0-9]{6,}$/.test(tx)){
      showError('Invalid transaction ID. Please check and enter a valid one (at least 6 characters, letters or numbers only).');
      return;
    }

    const orders = JSON.parse(localStorage.getItem('ogshop_orders_v1') || '[]');
    const order = { id: 'ORD'+Date.now(), customer:{name,phone}, items:cart, tx:tx||null, createdAt:new Date().toISOString() };
    orders.unshift(order);
    localStorage.setItem('ogshop_orders_v1', JSON.stringify(orders));
    localStorage.removeItem('ogshop_cart');

    successModal.classList.add('active');
  });

  document.getElementById('okBtn').addEventListener('click', ()=>{
    successModal.classList.remove('active');
    location.href = 'index.html';
  });
</script>
</body>
</html>
